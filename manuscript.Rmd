---
title             : "Full-day, in home validation of infant body position measurements from inertial sensors"
shorttitle        : "Infant position in the home"

author: 
  - name          : "John M. Franchak"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "UC Riverside Department of Psychology, 900 University Avenue, Riverside, CA 92521"
    email         : "franchak@ucr.edu"
  - name          : "Maximilian Tang"
    affiliation   : "1"
  - name          : "Hailey Rousey"
    affiliation   : "1"
  - name          : "Chuan Luo"
    affiliation   : "1"
      
authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  Abstract
  
keywords          : "body position, motor development, everyday experiences, sitting, machine learning"
wordcount         : "X"

bibliography      : "master.bib"

floatsintext      : no
linenumbers       : no
draft             : no
mask              : no
figurelist        : no
tablelist         : no
footnotelist      : no
csl               : apa.csl
classoption       : "man"
output            : papaja::apa6_pdf
header-includes:
  - \raggedbottom
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(papaja)
library(knitr)
library(patchwork)
library(scales)
library(ggforce)
library(hms)
library(tidyverse)
library(rstatix)
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
pos_levels <- c("Supine", "Prone", "Sitting", "Upright", "Held")
pal <-  c("#E69F00","#56B4E9", "#009E73","#F0E442", "#0072B2") %>% 
  set_names(pos_levels)

theme_update(text = element_text(size = 14),
             axis.text.x = element_text(size = 14, color = "black"), 
             axis.title.x = element_text(size = 16),
             axis.text.y = element_text(size = 14,  color = "black"), 
             axis.title.y = element_text(size = 16), 
             panel.background = element_blank(),panel.border = element_blank(), 
             panel.grid.major = element_blank(),
             panel.grid.minor = element_blank(), axis.line = element_blank(), 
             legend.key = element_rect(fill = "white")) 

```

Infants' movements facilitate and constrain how they interact with their surroundings from moment to moment. Changes in *body position*---whether infants are supine on their backs, prone on their bellies, sitting, upright, or held by a  caregiver---have immediate consequences for vision, object exploration, and social interaction. When sitting and upright, infants have a better view of faces and distant objects compared to their view while prone [@Freeplay; @LuoFranchak2020; @CWW]. Infants struggle to manipulate objects while supine and prone, but sitting affords object exploration [@SoskaAdolph2014]. 

# Goals of the Current Study

# Methods

## Participants

## Apparatus

## Procedure

```{r exemplartimeline, out.width="0.99\\linewidth", include=TRUE, fig.align="center", fig.cap="Example Timeline Caption.", echo=FALSE}
knitr::include_graphics("figures/timeline.png")
# Generated from analysis-pt2/methods-exemplar-agreement.R
# Annotated in illustrator based on event times:
# Exemplar participant is 120-1
# > pt2_start_time = "2022-11-13 11:11:00 PST"
# > pt2_end_time = "2022-11-13 12:41:01 PST"
# > session_param$start_time_coded = "2022-11-13 10:02:40 PST"
```

## Body position annotation

## Body position classification

# Results

## Goal 1: Assess the proximal accuracy of body position classification models

<!-- group_split_metrics, generated from group_split_comparison in this proj, stable copy in data/ -->

```{r metrics, warning=FALSE, fig.cap="Metrics", fig.align="center", fig.width=5, fig.height=8}
metrics <- read_csv("data/group_split_metrics.csv") %>% 
  filter(model %in% c("group", "split")) %>% 
  mutate(Model = factor(model, levels = c("group", "split"), labels = c("Group", "Individual")))

metrics_long <- metrics %>% pivot_longer(cols = `Overall Accuracy`:Kappa, 
                                         names_to = "metric",
                                         values_to = "value")

metric_plot <- function(ds, met) {
  ds %>% filter(metric == met) %>% 
    ggplot(aes(x = Model, y = value)) + 
    geom_sina(alpha = .7, fill = "turquoise3", size = 4, maxwidth = .5, shape = 21) +
    stat_summary(fun = "mean", mapping = aes(x = Model, y = value), shape = "-", fill = "black", size = 4) + 
    ylim(0, 1) + ylab(met) + xlab("") + 
    theme(plot.title.position = "plot",
          axis.title.y = element_text(size = 13),
          axis.text.y = element_text(size = 11),
          axis.text.x = element_text(size = 13))
}
metric_labels <- c("Overall Accuracy", "Balanced Accuracy", "F1", "Sensitivity", "Pos Pred Value", "Kappa")
title_labels <- c("A. Overall Accuracy", "B. Balanced Accuracy", "C. F1 Score", "D. Sensitivity", "E. Pos. Pred. Value", "F. Kappa")
metric_plots <- map(metric_labels, ~ metric_plot(metrics_long, .x)) %>% map2(., title_labels, ~.x + ggtitle(.y))
(metric_plots[[1]] + metric_plots[[2]])/(metric_plots[[3]]+metric_plots[[4]])/(metric_plots[[5]] + metric_plots[[6]])

#Worst three Kappa individuals are 9, 111-4, and 120-2
#Worst three Kappa groups are 9, 110-4
#Worst three Overall Accuracy (grouped) are 104-1, 106-1, 108-2 (first two are pt 2 outliers)

```

```{r metricstable}

metrics_long %>% group_by(Model, metric) %>% 
  get_summary_stats(value) %>% 
  select(-(variable:max), -(q1:mad), -se, -ci) %>% 
  pivot_wider(names_from = Model, values_from = c("median", "mean", "sd")) %>% 
  filter(metric != "Neg Pred Value", metric != "Specificity") %>% 
  relocate(mean_Group, .after = median_Group) %>% 
  relocate(sd_Group, .after = mean_Group) %>% 
  mutate(across(-metric, ~ apa_num(.x, digits = 3)),
         metric = factor(metric, levels = metric_labels)) %>% 
  arrange(metric) %>% 
  apa_table(., col.names = c("Metric", "Median", "Mean", "SD", "Median", "Mean", "SD"),    col_spanners = list("Group" = c(2, 4), "Individual" = c(5, 7)),
          caption = "Summary statistics for model performance metrics shown separately for group and individual models.")
```

\renewcommand{\arraystretch}{.75}

```{r metricsbyclass}
metrics_class <- read_csv("data/group_split_metrics_class.csv") %>% 
  filter(model %in% c("group", "split")) %>% 
  mutate(Model = factor(model, levels = c("group", "split"), labels = c("Group", "Individual")))

metrics_long_class <- metrics_class %>% pivot_longer(cols = `Balanced Accuracy`:Kappa, 
                                         names_to = "metric",
                                         values_to = "value")

metrics_long_summary <- metrics_long_class %>% group_by(Class,Model, metric) %>% 
  get_summary_stats(value) %>% 
  select(-(variable:max), -(q1:mad), -se, -ci) %>% 
  pivot_wider(names_from = Model, values_from = c("median", "mean", "sd")) %>% 
  filter(metric != "Neg Pred Value", metric != "Specificity") %>% 
  relocate(mean_Group, .after = median_Group) %>% 
  relocate(sd_Group, .after = mean_Group) %>% 
  mutate(across(-(Class:metric), ~ apa_num(.x, digits = 3)),
         metric = factor(metric, levels = metric_labels),
         Class = factor(Class, levels = c("Supine", "Prone", "Sitting", "Upright", "Held"))) %>% 
  relocate(metric, .before = Class) %>% 
  arrange(metric, Class) 

class_table <- metrics_long_summary %>% mutate(metric = as.character(metric))
class_table$metric[duplicated(class_table$metric)] <- " "

apa_table(class_table, col.names = c("Metric","Position", "Median", "Mean", "SD", "Median", "Mean", "SD"), col_spanners = list("Group" = c(3, 5), "Individual" = c(6, 8)),
          midrules = c(5, 10, 15, 20),
          caption = "Model performance metrics for each body position category, shown separately for group and individual models.")
```

## Goal 2: Assess the distal accuracy of body position classification models

<!-- compiled_agreement, generated from analysis-part2 -->

```{r part2overall, warning=FALSE, fig.cap="Overall agreement between human-coded body position and model-predicted body position in the distal comparison. Agreement for group models is shown in (A) and agreement for individual models is shown in (B). Plots are shown separately for each body position with a reference line that indicates perfect agreement; each point in a plot represent data for a single participant. The three outlier participants are plotted in dark gray, with a different shape marking each individual.", fig.align="center", fig.width=7, fig.height=6.5}

# PART 2 AGREEMENT
pt2_group <- read_csv("data/compiled_agreement_position.csv") %>% 
  filter(nap_period == 0 & exclude_period == 0 & !is.na(code) & !is.na(pos)) %>% 
         mutate(pos = factor(pos, levels = pos_levels))
pt2_split <- read_csv("data/compiled_agreement_split.csv") %>% 
  filter(nap_period == 0 & exclude_period == 0 & !is.na(code) & !is.na(pos)) %>% 
         mutate(pos = factor(pos, levels = pos_levels))

outlier_files <- c("107/3", "104/1", "106/1")
filter_outliers <- . %>% filter(!(file %in% outlier_files))

# Count up position totals and join into an agreement data frame
calculate_agreement <- function(ds) {
  model <- ds %>% count(file, pos) %>% 
    add_count(file, wt = n, name = "total") %>% 
    mutate(prop_model = n/total)
  human <- ds %>% count(file, code) %>% 
    add_count(file, wt = n, name = "total") %>% 
    mutate(prop_human = n/total)
  agree_group <- full_join(select(model, file, pos, prop_model), 
                     select(human, file, code, prop_human), 
                     by = c("file" = "file", "pos" = "code"))
  agree_group <- agree_group %>% mutate(prop_human = ifelse(is.na(prop_human), 0, prop_human),
                            prop_model = ifelse(is.na(prop_model), 0, prop_model))
  agree_group <- complete(agree_group, file, pos, fill = list(prop_human = 0, prop_model = 0))
}

agree <- map(list("group" = pt2_group, "split" = pt2_split), calculate_agreement)

agreement_scatter <- function(ds) {
  ggplot() +
  geom_point(data = filter(ds, file %in% outlier_files), mapping = aes(x = prop_human, y = prop_model, shape = file, fill = pos), fill = "#333333", size = 4, alpha = .5) + 
  geom_point(data = filter_outliers(ds), mapping = aes(x = prop_human, y = prop_model, fill = pos), shape = 21, alpha = .5, size = 4) + 
  geom_abline(intercept = 0, slope = 1) + 
  scale_fill_manual(values = pal, guide = "none") + 
  scale_shape_manual(guide = "none", values = 22:24) + 
  scale_x_continuous(breaks = c(0,.5,1), labels = c(0, 50, 100), limits = c(-.07, 1.07), name = "Actual Prevalence (%)") + 
  scale_y_continuous(breaks = c(0,.5,1), labels = c(0, 50, 100), limits = c(-.07, 1.07), name = "Predicted Prevalence (%)") + 
  facet_wrap("pos", ncol = 2, as.table = F) +
  theme(panel.spacing.x = unit(1, "lines")) +
  theme(panel.spacing.y = unit(1, "lines")) + 
  theme(strip.background = element_blank(), strip.text.x = element_text(size = 16, face = "bold"))
}

agree_plots <- map(agree, agreement_scatter)
agree_plots <- map2(agree_plots, c("A. Group Models", "B. Individual Models"), ~ .x + ggtitle(.y))
agree_plots[[1]] + agree_plots[[2]]
```

```{r, pt2overalltable}
#By posture
pt2corr_with_outliers <- map_dfc(agree, ~ .x %>% group_by(pos) %>% cor_test(vars = c("prop_model", "prop_human")) %>% select(pos, cor)) %>% select(-`pos...3`)
pt2corr_without_outliers <- map_dfc(agree, ~ .x %>% filter_outliers %>% group_by(pos) %>% cor_test(vars = c("prop_model", "prop_human")) %>% select(pos, cor)) %>% select(-`pos...1`,-`pos...3`)
pt2corr <- bind_cols(pt2corr_with_outliers, pt2corr_without_outliers)
rm(pt2corr_with_outliers)
rm(pt2corr_without_outliers)

#Overall
group_agree_cor <- cor_test(agree$group, vars = c("prop_model", "prop_human")) %>% pull(cor)
split_agree_cor <- cor_test(agree$split, vars = c("prop_model", "prop_human")) %>% pull(cor)
group_agree_cor_noout <- agree$group %>% filter_outliers %>% 
  cor_test(vars = c("prop_model", "prop_human")) %>% pull(cor)
split_agree_cor_noout <- agree$split %>% filter_outliers %>%
  cor_test(vars = c("prop_model", "prop_human")) %>% pull(cor)
overall_row <- tibble("Overall", group_agree_cor, split_agree_cor, group_agree_cor_noout, split_agree_cor_noout)
colnames(overall_row) <- colnames(pt2corr)
pt2corr <- bind_rows(pt2corr, overall_row)
apa_table(pt2corr, col.names = c("Position", "Group", "Individual", "Group", "Individual"), col_spanners = list(`With Outliers` = c(2, 3), `Without Outliers` = c(4, 5)),
          midrules = 5, caption = "Correlations between human-coded and model-predicted body position durations across the entire long delay period. Correlations are provided within each posture and overall, and computed separately using group and individual models with and without outlier participants.")
```

```{r part2bins, warning=FALSE, fig.cap="Prediction performance (difference in minutes between human-coded and model-predicted body position) for 10-minute bins in the distal comparison. Each point shows the mean and SE for a single participant for each body position, summarizing the prediction difference for each of their 10-minute bins. Points falling within the gray shaded region indicate that average prediction errors were less than 1 minute. Performance is plotted separately for (A) group models and (B) individual models. The three outlier participants are plotted in dark gray, with a different shape marking each individual.", fig.align="center", fig.width=8, fig.height=4.5}
calculate_agreement_bins <- function(ds) {
  ds <- ds %>% group_by(file) %>% 
    mutate(sample = row_number(), bin = floor(sample/300)) %>% 
    add_count(file, bin) %>% ungroup() %>% filter(n > 200) %>% group_by(file) %>% mutate(num_bins = length(unique(bin))) %>% ungroup()
  model <- ds %>% count(file, bin, num_bins, pos) %>% add_count(file, bin,num_bins,  wt = n, name = "total") %>% mutate(prop_model = n/total)
  human <- ds %>% count(file, bin, num_bins,  code) %>% add_count(file, bin, num_bins, wt = n, name = "total") %>% mutate(prop_human = n/total)
  agree <- full_join(select(model, file, pos, prop_model, bin, num_bins), 
                     select(human, file, code, prop_human, bin, num_bins), 
                     by = c("file" = "file", "pos" = "code", "bin" = "bin", "num_bins" = "num_bins"))
  agree <- agree %>% mutate(prop_human = ifelse(is.na(prop_human), 0, prop_human),
                            prop_model = ifelse(is.na(prop_model), 0, prop_model),
                            pos - factor(pos, levels = pos_levels))
  agree <- complete(agree, nesting(file, bin, num_bins), pos, fill = list(prop_human = 0, prop_model = 0))
}

agree_bins <- map(list("group" = pt2_group, "split" = pt2_split), calculate_agreement_bins)

difference_plot <- function(ds) {
  ds <- mutate(ds, diff = prop_human - prop_model)
  ggplot(filter_outliers(ds), aes(x = pos, y = diff, fill = pos, group = file)) +
  annotate("rect", xmin = -Inf, xmax = Inf, ymin = -.1, ymax = .1, fill = "gray", color = "gray") + 
  #geom_rect(aes(xmin = "Held", xmax = "Upright",ymin = -.1, ymax = .1), fill = "#e5e5e5", color = "#e5e5e5") + 
  stat_summary(data = filter(ds, file %in% outlier_files), position = position_dodge(.4), aes(shape = file), fill = "#333333", size = .75, stroke = .25) +
  stat_summary(position = position_dodge(.4), shape = 21, size = .75, stroke = .25) +
  scale_fill_manual(values = pal, guide = "none") +
  scale_shape_manual(guide = "none", values = 22:24) + 
  coord_cartesian(ylim = c(-1, 1)) + xlab("") + 
  scale_y_continuous(name = "Prediction Difference (min)", breaks = seq(-1, 1, .2), labels = seq(-10, 10, 2), minor_breaks = waiver()) + 
    theme(axis.text.x = element_text(size = 13, color = "black"))
}
difference_plots <- map(agree_bins, ~ difference_plot(.x))
difference_plots <- map2(difference_plots, c("A. Group Models", "B. Individual Models"), ~ .x + ggtitle(.y))
difference_plots[[1]] + difference_plots[[2]]
```

```{r pt2binstable}
#Bins
pt2corr_with_outliers <- map_dfc(agree_bins, ~ .x %>% group_by(pos) %>% cor_test(vars = c("prop_model", "prop_human")) %>% select(pos, cor)) %>% select(-`pos...3`)
pt2corr_without_outliers <- map_dfc(agree_bins, ~ .x %>% filter_outliers %>% group_by(pos) %>% cor_test(vars = c("prop_model", "prop_human")) %>% select(pos, cor)) %>% select(-`pos...1`,-`pos...3`)
pt2corr_bins <- bind_cols(pt2corr_with_outliers, pt2corr_without_outliers)
rm(pt2corr_with_outliers)
rm(pt2corr_without_outliers)

group_agree_cor <- cor_test(agree_bins$group, vars = c("prop_model", "prop_human")) %>% pull(cor)
split_agree_cor <- cor_test(agree_bins$split, vars = c("prop_model", "prop_human")) %>% pull(cor)
group_agree_cor_noout <- agree_bins$group %>% filter_outliers %>% 
  cor_test(vars = c("prop_model", "prop_human")) %>% pull(cor)
split_agree_cor_noout <- agree_bins$split %>% filter_outliers %>%
  cor_test(vars = c("prop_model", "prop_human")) %>% pull(cor)
overall_row <- tibble("Overall", group_agree_cor, split_agree_cor, group_agree_cor_noout, split_agree_cor_noout)
colnames(overall_row) <- colnames(pt2corr_bins)
pt2corr_bins <- bind_rows(pt2corr_bins, overall_row)
rm(overall_row)
apa_table(pt2corr_bins, col.names = c("Position", "Group", "Individual", "Group", "Individual"), col_spanners = list(`With Outliers` = c(2, 3), `Without Outliers` = c(4, 5)),
          midrules = 5, caption = "Correlations between human-coded and model-predicted body position durations using 10-minute bins during the distal comparison. Correlations are provided within each posture and overall, and computed separately using group and individual models with and without outlier participants.")
```

## Goal 3: Examine the data quality of full-day home recordings

<!-- imu-compiled.csv, generated from analysis-lena-imu/compile_lena_imu.R -->

```{r timelines, warning=FALSE, fig.cap="Timelines", fig.align="center", fig.width=7.75, fig.height=8}
timeline_data <- read_csv("data/imu-compiled.csv") %>% 
  mutate(id_uni = factor(id*100+session),
         group = factor(ifelse(age <= 8, "Younger", "Older")),
         nap_time = ifelse(is.na(sit_time), nap_time, NA)) %>% 
  pivot_longer(cols = nap_time:upright_time, names_to = "position", values_to = "prop") %>% 
  mutate(Position = factor(position,
                           levels = c("nap_time","upright_time", "sit_time", "prone_time", "supine_time", "held_time"),
                           labels = c("Nap","Upright", "Sitting", "Prone", "Supine", "Held"))) %>% 
  arrange(Position, age)

timelines <- function(ds) {
  lims <- as_hms(c('09:00:00', '21:59:00'))
  hour_breaks = as_hms(c('09:00:00', '10:00:00', '11:00:00', '12:00:00', '13:00:00', '14:00:00', '15:00:00', '16:00:00', '17:00:00', '18:00:00', '19:00:00', '20:00:00', '21:00:00'))
  label_breaks = c("9am","","11am","","1pm","","3pm","","5pm","","7pm","","9pm")
  ggplot(ds, aes(x = clock_time_start, y = prop, fill = Position)) + 
  geom_bar(stat = "identity") + 
  facet_wrap("id_uni",ncol = 1, strip.position = "left") + 
  scale_fill_manual(values = c("Nap" = "gray",pal), name = "") + 
  scale_x_time(breaks = hour_breaks, labels = label_breaks, name = "", limits = lims) + 
  theme(legend.position = "bottom", 
        axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        strip.background = element_blank(),
        axis.text.x = element_text(size = 11),
        strip.text.y = element_blank()) + ylab("")
  #https://ggplot2tor.com/scales/scale_x_time for options
}

timeline_plots <- map(c("Younger", "Older"), ~ timelines(filter(timeline_data, group == .x)))
timeline_plots <- map2(timeline_plots, c("A. 4-7 Months", "B. 11-14 Months"), ~ .x + ggtitle(.y))
timeline_plots[[1]] + timeline_plots[[2]]
```

## Goal 4: Assess the suitability of full-day predictions for capturing age differences in body position

<!-- imu-compiled.csv, generated from analysis-lena-imu/compile_lena_imu.R -->

```{r age, warning=FALSE, fig.cap="Age trends", fig.align="center", fig.width=7.5, fig.height=7}
fullday_group <- read_csv("data/imu-compiled.csv") %>% 
  mutate(id_uni = factor(id*100+session),
         group = factor(ifelse(age <= 8, "Younger", "Older")),
         nap_time = ifelse(is.na(sit_time), nap_time, NA))
fullday_split <- read_csv("data/imu-compiled-split.csv") %>% 
  mutate(id_uni = factor(id*100+session),
         group = factor(ifelse(age <= 8, "Younger", "Older")),
         nap_time = ifelse(is.na(sit_time), nap_time, NA))
fullday <- list("group" = fullday_group, "split" = fullday_split)

fullday_long <- function(ds) {
  ds %>% pivot_longer(cols = sit_time:upright_time, names_to = "position", values_to = "prop") %>% 
  mutate(position = factor(position,
                           levels = c("upright_time", "sit_time", "prone_time", "supine_time", "held_time"),
                           labels = c("Upright", "Sitting", "Prone", "Supine", "Held"))) %>% 
  arrange(position, age)
}

age_scatter <- function(ds) {
  ds %>% drop_na(prop) %>% 
  ggplot() + facet_wrap("position", as.table = T, ncol = 2) + 
  geom_smooth(aes(x = age, y = prop), color = "#191919", method = "lm", se = T) + 
  stat_summary(fun = "mean", mapping = aes(x = age, y = prop, group = id_uni, fill = position), shape = 21, size = .7) + 
  scale_fill_manual(values = pal, guide = "none") + 
  scale_x_continuous(name = "Age (months)", breaks = seq(3, 15, 3), limits = c(3,15)) + 
  ylim(0,1) + ylab("Proportion of waking day") + 
  theme(panel.spacing.x = unit(.5, "lines")) +
  theme(panel.spacing.y = unit(1, "lines")) + 
  theme(strip.background = element_blank(), strip.text.x = element_text(size = 16, face = "bold"))
}

age_plots <- map(fullday, fullday_long) %>% map(age_scatter)
age_plots <- map2(age_plots, c("A. Group Models", "B. Individual Models"), ~ .x + ggtitle(.y))
age_plots[[1]] + age_plots[[2]]

# outlier_ids <- c(10701, 10401, 10601)
# fullday %>% cor_mat(age, sit_time:upright_time) %>% cor_mark_significant()
# fullday %>% filter(!(id_uni %in% outlier_ids)) %>% cor_mat(age, sit_time:upright_time) %>% cor_mark_significant()
# 
# fullday_long %>% group_by(position, group) %>% get_summary_stats(prop)

```

```{r agetable}
pos_sum_age <- map(fullday, fullday_long) %>% 
  map(~ group_by(.x, group, position, id_uni) %>% 
            mutate(prop = prop * 100) %>% 
            get_summary_stats(prop) %>% 
            group_by(group, position) %>% 
            get_summary_stats(mean) %>% 
            select(group, position, mean, sd))
pos_sum_age <- pos_sum_age %>% map2_dfr(c("Group", "Individual"), 
                         ~ mutate(.x, Model = .y,
                                  mean_sd = str_glue("{apa_num(mean, digits = 1)}% ({apa_num(sd, digits = 1)})")) %>% 
                           select(-mean, -sd) %>% 
                           pivot_wider(names_from = group, values_from = mean_sd)) %>% 
  pivot_wider(names_from = Model, values_from = c("Younger", "Older")) %>% 
  relocate(Younger_Individual, .after = Older_Group)
apa_table(pos_sum_age, col.names = c("Position", "Younger", "Older", "Younger", "Older"), col_spanners = list("Group" = c(2, 3), "Individual" = c(4, 5)),
          caption = "Summary of age differences in full-day body position for younger (4- to 7-month) and older (11- to 14-month) infants. Values shown are the mean percent of time for each body position averaged across infants in each group. Standard deviations are shown in parentheses. Descriptive statistics are shown separately for group and individual models.")

```

# Discussion

\newpage

# References

::: {#refs custom-style="Bibliography"}
:::
